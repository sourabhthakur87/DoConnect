<!-- MENU -->
<div class="overlay" *ngIf="isMenuOpen" (click)="closeMenu()"></div>
<app-user-nav [isOpen]="isMenuOpen" (closeMenu)="closeMenu()"></app-user-nav>

<!-- TOPBAR -->
<div class="topbar">
  <button *ngIf="!isMenuOpen" (click)="toggleMenu()" class="menu-btn">☰</button>
  <h4>DoConnect - User</h4>
</div>

<div class="search-container">
  <input type="text" [(ngModel)]="searchQuery" (ngModelChange)="onSearchChange()"
    placeholder="Search approved questions..." />
  <p class="notfound">{{Notfound}}</p>
</div>

<h1 class="page-title">
  Approved Questions
</h1>

<!-- ✅ Questions List -->
<div *ngFor="let question of approvedQ" class="question-card">
  <div class="flx">
    <div>
      <p><strong>Asked By:</strong> {{ question.askedBy }}</p>
      <h3>{{ question.questionTitle }}</h3>
      <p>{{ question.questionText }}</p>
    </div>

    <!-- Image -->
    <div class="imagediv">
      <img *ngIf="question.imagePath; else defaultImage" [src]="'http://localhost:5122/images/' + question.imagePath"
        alt="Question Image" (click)="showLargeImage(question.imagePath)">
      <ng-template #defaultImage>
        <img src="download.jpeg" alt="Default Image">
      </ng-template>
    </div>
  </div>

  <button class="answer-btn" (click)="giveAnswer(question.questionId)">
    Give Answer
  </button>

  <!-- ✅ Embedded Answer Form -->
  <div *ngIf="activeAnswerFormId === question.questionId" class="answer-form-wrapper">
    <h2 class="section-title">Add Answer</h2>

    <form [formGroup]="addAnswer" (ngSubmit)="onSubmit(question.questionId)" class="answer-form">
      <label for="answertext">Your Answer:</label>
      <textarea id="answertext" formControlName="answertext" rows="5" placeholder="Type your answer..."
        required></textarea>

      <div class="form-group">
        <label for="file">Upload Image:</label>
        <input type="file" (change)="onFileSelected($event)" accept="image/*" />
      </div>

      <div *ngIf="message" class="form-message">{{ message }}</div>

      <button type="submit" [disabled]="addAnswer.invalid">Submit</button>
    </form>
  </div>

</div>

<!-- Modal -->
<div *ngIf="selectedImage" class="modal">
  <div class="modal-content">
    <span class="close-btn" (click)="closeModal()">×</span>
    <img [src]="'http://localhost:5122/images/' + selectedImage" alt="Enlarged Image" class="large-image">
  </div>
</div>